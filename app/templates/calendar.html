{% extends "base.html" %}
{% block head %}

  <title>Kalendarz zadań</title>
    <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FullCalendar (CSS + JS) -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
  <style>
    :root {
  --sportwin-primary: #6dc000;
  --sportwin-primary-hover: #509100;
  --sportwin-bg: #f3f6fb;
  --sportwin-card-bg: #ffffff;
  --sportwin-text: #232b3a;
  --sportwin-muted: #9aa4b2;
}
body {
  background: var(--sportwin-bg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  color: var(--sportwin-text);
}
/* Zadanie spóźnione (niezakończone po czasie) */
.fc-event-overdue,
.fc-timegrid-event.fc-event-overdue,
.fc-daygrid-event.fc-event-overdue {
  background: #dc2626 !important;   /* czerwony */
  border-color: #b91c1c !important;
}
/* Główne "pudełko" kalendarza */
.fc {
  background: var(--sportwin-card-bg);
  border-radius: 18px;

  padding: 24px 24px 16px;
  border: none;
}
/* Górny toolbar */
.fc .fc-toolbar.fc-header-toolbar {
  margin-bottom: 1.5rem;
}
.fc-scrollgrid-section-header .fc-scroller{
  overflow: visible !important;
}
/* Tytuł miesiąca */
.fc .fc-toolbar-title {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--sportwin-text);
}

/* Kontener z przyciskami */
.fc .fc-toolbar-chunk {
  display: flex;
  gap: 0.5rem;
}

/* Wszystkie przyciski */
.fc .fc-button {
  background: var(--sportwin-primary);
  border: none;
  border-radius: 0px;
  padding: 0.45rem 0.9rem;

  font-size: 0.85rem;
  font-weight: 600;
  text-transform: none;
}

/* Hover / active */
.fc .fc-button:hover,
.fc .fc-button:focus {
  background: var(--sportwin-primary-hover);

}

/* Wybrany zakres (np. Today) */
.fc .fc-button-primary:not(:disabled).fc-button-active,
.fc .fc-button-primary:not(:disabled):active {
  background: var(--sportwin-primary-hover);
  border: none;
}

/* Wyłączenie niebieskich ramek itd. */
.fc .fc-button:focus {
  outline: none;
}
/* Usunięcie grubych szarych ramek */
.fc-theme-standard td,
.fc-theme-standard th {
  border-color: #e5e7eb;
}

/* Header z nazwami dni */
.fc .fc-col-header-cell {
  background: transparent;
  padding: 0.4rem 0;
  color: var(--sportwin-muted);
  font-weight: 600;
  border-bottom: 1px solid #e5e7eb;
}

/* Komórki dni – delikatne tło */
.fc .fc-daygrid-day {
  background: #f9fafb;
}

/* Liczba dnia */
.fc .fc-daygrid-day-number {
  color: var(--sportwin-text);
  font-weight: 600;
}

/* Dzisiejsza data – zielone, ale pastelowe tło */
.fc .fc-day-today {
  background: rgba(122, 216, 0, 0.08);
}
.fc-event-time{
  color: #ffffff;
}
.fc-daygrid-event-dot
{
  border: calc(var(--fc-daygrid-event-dot-width) / 2) solid #ffffff;
}
/* Dzisiejsza liczba dnia */
.fc .fc-day-today .fc-daygrid-day-number {
  color: var(--sportwin-primary);
}
/* Pojedyncze eventy */
.fc .fc-daygrid-event {
  background: var(--fc-event-bg-color);
  border-radius: 0;
  border: none;
  padding: 0.1rem 0.4rem;
  font-size: 0.75rem;
  font-weight: 500;
}

/* Tekst eventu */
.fc .fc-daygrid-event .fc-event-title {
  color: #ffffff;
}

.fc .fc-view-harness{
  height: 580px !important;
}
.fc{
  border-radius: 0 !important;
}
/* przycisk X w prawym górnym rogu eventu */
.fc-event .event-delete-btn {
  position: absolute;
  top: 2px;
  right: 3px;
  background: rgba(0, 0, 0, 0.4);
  color: #fff;
  border: none;
  border-radius: 9999px;
  width: 18px;
  height: 18px;
  font-size: 12px;
  text-align: center;
  cursor: pointer;
  padding: 0;
  z-index: 5;
}
.fc-event .event-delete-btn:hover {
  background: rgba(220, 38, 38, 0.9); /* czerwony na hover */
}
.fc-timegrid-event{
  border-radius: 0;
}

/* Uchwyt do resize na dole eventu z widocznym "v" */
.fc-timegrid-event .fc-event-resizer-end {
  height: 14px;
  bottom: 0px !important;
  background: #1d4ed8;          /* ciemny pasek na dole */
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: ns-resize;
  border: 2px solid #1d4ed8;
}
.fc-event-complete,
.fc-timegrid-event.fc-event-complete,
.fc-daygrid-event.fc-event-complete {
  background: #16a34a !important;   /* ładna zieleń */
  border-color: #15803d !important;
}
/* Ulepszenia na mobile */
@media (max-width: 768px) {
  /* toolbar w jednej kolumnie, żeby się nie ściskał */
  .fc .fc-toolbar.fc-header-toolbar {
    flex-direction: column;
    align-items: stretch;
    gap: 4px;
  }

  /* trochę mniejsze czcionki */
  .fc .fc-toolbar-title {
    font-size: 16px;
  }

  .fc .fc-timegrid-slot-label {
    font-size: 10px;
  }

  .fc .fc-timegrid-slot {
    height: 2rem; /* mniejsze sloty godzinowe */
  }
}
  </style>
{% endblock %}
{% block body %}

  <div class="max-w-6xl mx-auto py-8 px-6 lg:px-0">
    <div id="calendar" class="bg-slate-50 shadow p-4"></div>
  </div>

  <!-- MODAL Tailwind -->
  <div id="taskModal"
       class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden">
    <div class="bg-slate-50 shadow-xl max-w-md w-full mx-4 p-6">
      <h2 class="text-lg font-semibold text-gray-900 mb-2" id="modalTitle"></h2>
      <p class="text-sm text-gray-700 mb-4" id="modalDescription"></p>

      <div class="flex justify-end">
        <button type="button"
                id="closeModal"
                class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200">
          Zamknij
        </button>
      </div>
    </div>
  </div>
  <div
  id="createTaskModal"
  class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden"
>
  <!-- OKNO MODALA -->
  <div class="bg-white shadow p-6 w-full max-w-md relative">
    <button
      type="button"
      id="createTaskModalClose"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700"
    >
      ✕
    </button>

    <h2 class="text-xl font-semibold mb-4">Dodaj zadanie</h2>

    <form class="py-2 flex flex-col gap-4" id="createTaskForm">
      <input
        class="p-2 border border-gray-300"
        placeholder="Nazwa zadania"
        type="text"
        name="content"
        id="content"
        required
      />
      <textarea
        class="p-2 border border-gray-300"
        placeholder="Opis"
        name="description"
        id="description"
        rows="4"
      ></textarea>
        <div class="flex flex-col gap-1">
          <label for="complete" class="text-sm text-gray-700">Status</label>
          <select
            id="complete"
            name="complete"
            class="p-2 border border-gray-300"
          >
            <option value="0">Nierozpoczęte</option>
            <option value="1">W trakcie</option>
            <option value="2">Zakończone</option>
          </select>
        </div>

      <!-- UKRYTE POLA NA DATY -->
      <input type="hidden" id="taskStart" name="start" />
      <input type="hidden" id="taskEnd" name="end" />
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input
        class="py-2 px-4 bg-green-600 hover:bg-green-700 text-slate-100 hover:cursor-pointer"
        type="submit"
        value="Utwórz zadanie"
        id="btn_add"
      />
    </form>
  </div>
</div>
<!-- MODAL POTWIERDZENIA USUNIĘCIA -->
<div
  id="deleteTaskModal"
  class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden"
>
  <div class="bg-white shadow p-6 w-full max-w-md relative">
    <h2 class="text-xl font-semibold mb-4">Usuń zadanie</h2>
    <p class="mb-4" id="deleteTaskText">
      Czy na pewno chcesz usunąć to zadanie?
    </p>
    <div class="flex justify-end gap-2">
      <button
        type="button"
        id="cancelDeleteTask"
        class="px-4 py-2 bg-gray-300 hover:bg-gray-400"
      >
        Anuluj
      </button>
      <button
        type="button"
        id="confirmDeleteTask"
        class="px-4 py-2 bg-red-600 text-white hover:bg-red-700"
      >
        Usuń
      </button>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/calendar.js') }}"></script>
{% endblock %}